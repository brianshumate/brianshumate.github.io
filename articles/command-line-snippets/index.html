<!DOCTYPE html><html><head><title>Command Line Snippets | Brian Shumate</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><link rel="icon" type="image/png" href="/img/favicon-196x196.png" sizes="196x196"><link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/img/favicon-128.png" sizes="128x128"><meta name="application-name" content="Brian Shumate"><meta name="msapplication-TileColor" content="#F5AB35"><meta name="msapplication-TileImage" content="/img/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="/img/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="/img/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="/img/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="/img/mstile-310x310.png"><link rel="stylesheet" href="/css/foundation.css"><link rel="stylesheet" href="/css/foundation-icons.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/app.css"><script src="//use.edgefonts.net/orbitron.js"></script></head><body><header><div class="top-bar"><div class="top-bar-left"><ul class="menu"><li class="menu-text"><a href="/"><img src="/img/brand.svg" width="24" height="24" class="svg-inject brand-all"><span>Brian </span><span>Shumate</span></a></li></ul></div><div class="top-bar-right"><ul class="menu"><li><a href="/about/">About</a></li><li><a href="/articles/">Articles</a></li><li><a href="/now/">Now</a></li><li><a href="/projects/">Projects</a></li></ul></div></div></header><div id="article-layout-main"><div class="row medium-8 large-7 columns"><article id="article"><br><hr class="dotted"><h1 id="command-line-snippets"><a class="heading-anchor" href="#command-line-snippets"><span></span></a>Command Line Snippets</h1><i><h5 id="-january-4th-2019-reading-time-5-min"><a class="heading-anchor" href="#-january-4th-2019-reading-time-5-min"><span></span></a> <i>January 4th, 2019&#xA0;&#xA0;&#xA0;</i><i class="fi-clock">&#xA0;&#xA0;Reading time 5 min</i></h5></i><div><p>Wherein I ramble on a bit about a command line tool that I enjoy using to curate my collection of complex and seldom used but powerful CLI one-liners/snippets, and share some that I&apos;ve made for certain command line tools.</p>
<!--more-->
<h2 id="the-fine-art-of-snippet-curation"><a class="heading-anchor" href="#the-fine-art-of-snippet-curation"><span></span></a>The Fine Art of Snippet Curation</h2>
<p>This article is aimed at folks who enjoy using their Unix-like operating system command line, and for those who would also like to learn about a neat tool and system for curating and using a personal collection of command line snippets.</p>
<p>Most specifically, let us consider the cognitive effort associated with recalling complex or powerful, but often little used command line snippets. For example, it can be extremely handy in certain circumstances to extract the files from a Debian <code>.deb</code> formatted package on a BSD style system, but who can easily recall that it is done with a command like:</p>
<pre><code>$ ar vx &lt;package_name.deb&gt;
</code></pre><p>or how about showing the number of connections in use by PID for a process with <code>strace</code>? That&apos;s:</p>
<pre><code>$ strace -p $(pidof &lt;process_name&gt;) -f -e trace=network -s 10000
</code></pre><p>How do I add an Internet password to the macOS Keychain from the command line again? Oh, yeah:</p>
<pre><code>$ security -v add-internet-password -a &lt;account&gt; -s &lt;server&gt; -w &lt;password&gt;
</code></pre><p>All the handy snippets a regular user of the command line cannot fit in their head need some other place to reside. For many, this place will often be a text file of some sort&amp;emdash; so how about the idea of using a text file of a certain format that brings useful per-snippet attributes and works with a neat CLI tool for managing and searching them?</p>
<p>Some people are successful with the built-in snippet capabilities of their preferred text editor. Having never really tried my editor&apos;s own snippet system, I wanted a more universal tool where the snippets had more usefulness both in and outside of the text editor environment as well.</p>
<p>To that end, I&apos;d previously used a GitHub gist to stash my snippets. Then eventually, a git repository of Markdown documents represented a carefully cataloged snippet collection, but let me tell you&amp;emdash; it was not as easy to search and keep synchronized between systems as it is with the tool I use for this purpose now.</p>
<h2 id="say-hello-to-pet"><a class="heading-anchor" href="#say-hello-to-pet"><span></span></a>Say hello to pet</h2>
<p>The tool in question is called <a href="https://github.com/knqyf263/pet">pet</a> by <a href="https://github.com/knqyf263">Teppei Fukuda</a>. It is a fantastic and focused MIT-licensed, Go-based CLI tool that interfaces with a listing of CLI snippets that you keep in a TOML formatted text file.</p>
<p>After using <code>pet</code> for about one year, I&apos;ve found it to be a minimalistic, but powerful approach to using snippets.</p>
<p>Once you have installed the <code>pet</code> binary, it can be used in handy ways, the simplest example being to just list the snippets:</p>
<pre><code>$ pet list
</code></pre><p>The output is essentially the complete raw TOML of your snippet collection:</p>
<p><img src="/articles/command-line-snippets/pet3.png" alt></p>
<p><small>Example output from <code>pet list</code></small></p>
<p>As your personal collection of snippets increases in number, you can use <code>pet search</code> to quickly find them:</p>
<pre><code>$ pet search
</code></pre><p><img src="/articles/command-line-snippets/pet0.png" alt></p>
<p><small>An example of pet search</small></p>
<p><code>pet</code> can automatically interface with two popular interactive filtering and selector CLI tools, <a href="https://github.com/junegunn/fzf">fzf</a> and <a href="https://github.com/peco/peco">peco</a> to make navigation and searching of your snippet collection a breeze.</p>
<p><img src="/articles/command-line-snippets/pet1.png" alt></p>
<p>Filtering in pet search</p>
<p>You can also tag snippets with <code>#</code> and search for tagged snippets by tag.</p>
<p>You can pass the search result/composed command to a clipboard wrangling tool like <code>pbcopy</code> on macOS:</p>
<pre><code>$ pet search | pbcopy
</code></pre><p>and have the command ready to use with a &#x2318;+v.</p>
<p>For Linux, you can do the same with <code>xclip</code> or <code>xsel</code>.</p>
<pre><code>$ pet search | xclip -selection clipboard
</code></pre><p>One of the nice things about the snippet format is that you can use dynamic argument placeholders for example values and <code>pet</code> will prompt you for the actual values, which it will then insert into the composed command line.</p>
<p>In practice, the UI prompting appears as shown in the following screenshot, which contains 3 arguments: a filename, a source string value, and a replacement string value.</p>
<p><img src="/articles/command-line-snippets/pet2.png" alt></p>
<p><small>An example of dynamic arguments</small></p>
<p>This results in a nicely composed and ready to use command line, like this:</p>
<pre><code>find ./ -name test-file.txt -exec sed -i &apos;&apos; -e &apos;s/sashimi/nigiri/g&apos; {} \;
</code></pre><p>The tool is simple and elegant in its usage while doing what it does very well.</p>
<p>You can use other <code>pet</code> commands to add new entries, like <code>pet new</code> or edit the existing snippets with <code>pet edit</code>, which will invoke the editor you specify in the configuration file.</p>
<p>You can also use <code>pet sync</code> to synchronize your snippet collection to a GitHub gist or to GitLab so that it can be readily used in multiple environments.</p>
<pre><code>$ pet sync
Upload success
</code></pre><p>Check out the <a href="https://github.com/knqyf263/pet/blob/master/README.md">pet README</a> for full documentation and usage examples!</p>
<h2 id="hashipets"><a class="heading-anchor" href="#hashipets"><span></span></a>hashipets</h2>
<p>As an example of a relatively comprehensive example snippet collection, I created <a href="https://github.com/brianshumate/hashipets">hashipets</a>, which is a curated collection of helpful snippets specifically for HashiCorp command line tools like <a href="https://www.vaultproject.io/">Vault</a>, <a href="https://www.consul.io/">Consul</a>, <a href="https://www.nomadproject.io/">Nomad</a>, <a href="https://packer.io/">Packer</a>, <a href="https://www.vagrantup.com/">Vagrant</a>, and <a href="https://www.terraform.io/">Terraform</a>.</p>
<p>Based on the accompanying <a href="https://github.com/brianshumate/hashipets/blob/master/README.md">README</a> from the <code>hashipets</code> project, I&apos;ll demonstrate here how they might be used with <code>pet</code> and <code>peco</code>. That guidance is specifically for a Mac, but I will show the process for Linux here instead.</p>
<h3 id="install-pet"><a class="heading-anchor" href="#install-pet"><span></span></a>Install pet</h3>
<p>The quickest way to install <code>pet</code> for Linux is to download a binary release from the GitHub project:</p>
<p>Visit <code>https://github.com/knqyf263/pet/releases</code> and download the correct <code>.tar.gz</code> for your OS and distribution. For example, <code>pet_0.3.4_linux_amd64.tar.gz</code>.</p>
<pre><code>$ sudo tar -C /usr/local/bin -xzf pet_0.3.4_linux_amd64.tar.gz

$ pet version
pet version 0.3.4
</code></pre><p>Yay, you now have <code>pet</code> installed!</p>
<h3 id="choose-a-selector-fuzzy-finder"><a class="heading-anchor" href="#choose-a-selector-fuzzy-finder"><span></span></a>Choose a Selector / Fuzzy Finder</h3>
<p>Now it&apos;s time to pick a fuzzy finder for use by pet; it&apos;s necessary for all of the convenience features, like searching. The most common of these tools and automatically supported are <a href="https://github.com/junegunn/fzf">fzf</a> and <a href="https://github.com/peco/peco">peco</a>.</p>
<p>The <code>hashipets</code> project example uses <code>peco</code>, so this guide will as well. Feel free to try <code>fzf</code> as it is a great search tool as well.</p>
<h4 id="install-peco"><a class="heading-anchor" href="#install-peco"><span></span></a>Install peco</h4>
<p>The quickest way to install <code>peco</code> for Linux is to download a binary release from the GitHub project:</p>
<p>Visit <code>https://github.com/peco/peco/releases</code> and download the correct <code>.tar.gz</code> for your OS and distribution.</p>
<p>In this example, it&apos;s <code>peco_linux_amd64.tar.gz</code> under the <strong>0.5.3</strong> release tag.</p>
<pre><code>$ tar  -zxf peco_linux_amd64.tar.gz
$ sudo cp peco_linux_amd64/peco /usr/local/bin/

$ peco --version
peco version v0.5.3 (built with go1.10)
</code></pre><p>You&apos;re now ready to configure <code>pet</code> and <code>peco</code>.</p>
<h4 id="configure-pet-to-use-hashipets-snippets"><a class="heading-anchor" href="#configure-pet-to-use-hashipets-snippets"><span></span></a>Configure pet to use hashipets snippets</h4>
<p>In this example, we will just clone the <code>hashipets</code> repository to a
temporary directory, then configure <code>pet</code> to use its snippets.</p>
<pre><code>$ export HASHIPETS=/tmp/hashipets
$ git clone https://github.com/brianshumate/hashipets.git $HASHIPETS
$ pet configure
</code></pre><p>Use the value from <code>$HASHIPETS</code> to create the full path for the <code>snippetfile</code> option value: <code>/tmp/hashipets/hashipets.toml</code>.</p>
<p>Here&apos;s a complete <code>pet</code> configuration example:</p>
<pre><code>$ cat ~/.config/pet/config.toml
[General]
  snippetfile = &quot;/tmp/hashipets/hashipets.toml&quot;
  editor = &quot;vim&quot;
  column = 40
  selectcmd = &quot;peco --layout=bottom-up&quot;

[Gist]
  file_name = &quot;my-custom-snippets.toml&quot;
  access_token = &quot;42c0ffee8ddc568ffc0ffeeae8ac0ffeebe2a474&quot;
  gist_id = &quot;c0ffee3b76be396c0ffeede8dc0ffe73&quot;
  public = false
</code></pre><p>Here&apos;s what&apos;s going on in the previous <code>config.toml</code> example:</p>
<ul>
<li><strong>General</strong> pet settings<ul>
<li><code>snippetfile</code>: the path to our snippets</li>
<li><code>editor</code>: the editor invoked with <code>pet edit</code></li>
<li><code>column</code>: the target display column width</li>
<li><code>selectcmd</code>: the command line for the select/search tool</li>
</ul>
</li>
<li><strong>Gist</strong> settings<ul>
<li><code>file_name</code> the gist filename</li>
<li><code>access_token</code>: the GitHub personal access token</li>
<li><code>gist_id</code> the gist ID string</li>
<li><code>public</code> whether the gist is public or not</li>
</ul>
</li>
</ul>
<h4 id="configure-peco"><a class="heading-anchor" href="#configure-peco"><span></span></a>Configure peco</h4>
<p>Go ahead and set up a custom <code>peco</code> configuration if you&apos;d like as well;
the one from hashipets is a good fun start:</p>
<pre><code>$ mkdir -p ~/.config/peco &amp;&amp;
  tee ~/.config/peco/config.json &lt;&lt;EOF
{
    &quot;Prompt&quot;: &quot;&#x1F436;  pet&gt;&quot;,
    &quot;Style&quot;: {
        &quot;Basic&quot;: [&quot;on_default&quot;, &quot;default&quot;],
        &quot;SavedSelection&quot;: [&quot;bold&quot;, &quot;on_yellow&quot;, &quot;white&quot;],
        &quot;Selected&quot;: [&quot;underline&quot;, &quot;on_cyan&quot;, &quot;black&quot;],
        &quot;Query&quot;: [&quot;yellow&quot;, &quot;bold&quot;],
        &quot;Matched&quot;: [&quot;white&quot;, &quot;bold&quot;]
    }
}
EOF
</code></pre><p>You can now try a command to get started; go ahead and search the
hashipets snippets:</p>
<pre><code>$ pet search
</code></pre><p>Provided all went well, you should be browsing the snippet list and be
able to search/filter them:</p>
<p><img src="/articles/command-line-snippets/pet4.png" alt></p>
<p><small>Browsing the hashipets snippets!</small></p>
<p>I hope this article and the projects in it have been useful to you.</p>
<p>Enjoy!</p>
</div><hr class="dotted"></article></div></div></body><footer><div class="row expanded callout secondary"><div class="large-4 columns"><h5 id="-photographie"><a class="heading-anchor" href="#-photographie"><span></span></a><i class="fi-camera"> </i>PHOTOGRAPHIE</h5><div class="row small-up-4"><div class="column"><a href="https://500px.com/photo/128380667/the-mist-by-brian-shumate"><img src="/img/500px/stock-photo-128380667.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/92822883/orb-by-brian-shumate"><img src="/img/500px/stock-photo-128380669.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380671/bee-by-brian-shumate"><img src="/img/500px/stock-photo-128380671.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380673/cicada-by-brian-shumate"><img src="/img/500px/stock-photo-128380673.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380675/butterfly-by-brian-shumate"><img src="/img/500px/stock-photo-128380675.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380677/foggy-fall-by-brian-shumate"><img src="/img/500px/stock-photo-128380677.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380679/old-homestead-by-brian-shumate"><img src="/img/500px/stock-photo-128380679.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380695/foggy-morning-by-brian-shumate"><img src="/img/500px/stock-photo-128380695.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div></div></div><div class="large-4 columns"><h5 id="choses-sociales-"><a class="heading-anchor" href="#choses-sociales-"><span></span></a><i class="fi-at-sign"></i>CHOSES SOCIALES<br><a href="https://twitter.com/brianshumate" title="Brian Shumate on Twitter"><i class="fi-social-twitter size-60"> </i></a><a href="https://github.com/brianshumate" title="Brian Shumate on GitHub"><i class="fi-social-github size-60"> </i></a><a href="https://500px.com/brianshumate" title="Brian Shumate on 500px"><i class="fi-social-500px size-60"> </i></a><a href="https://keybase.io/brianshumate" title="Brian Shumate on Keybase.io"><i class="fi-key size-60"></i></a></h5></div><div class="large-4 columns"><h5 id="de-la-fort"><a class="heading-anchor" href="#de-la-fort"><span></span></a><i class="fi-trees"></i>DE LA FOR&#xCA;T</h5><div id="hdt-quote" class="callout"><bloqckquote class="jsgood"><p>&#x201C;We must walk consciously only part way toward our goal, and then leap in the dark to our success.&#x201D;<br><br>&#x2014;Henry David Thoreau</p></bloqckquote><noscript><bloqckquote><p>&#x201C;We must walk consciously only part way toward our goal, and then leap in the dark to our success.&#x201D;<br><br>&#x2014;Henry David Thoreau</p></bloqckquote></noscript><p></p></div></div></div><div class="row expanded"><div class="medium-6 columns"><ul class="menu"><li><a href="/about/">About</a></li><li><a data-open="disclaimerModal">Disclaimer</a></li><li><a data-open="gpgModal">GPG</a></li><li><a href="/license/">License</a></li></ul></div><div class="medium-6 columns"><ul class="menu align-right"><li class="menu-text">Copyright &#xA9; 2019 Brian Shumate</li></ul></div></div></footer><div id="disclaimerModal" data-reveal class="large reveal"><h1 id="disclaimer"><a class="heading-anchor" href="#disclaimer"><span></span></a><i class="fi-info"></i>DISCLAIMER</h1><p class="lead">This is a personal website comprised of personally held opinions. All content provided on this website is for informational purposes only. Brian Shumate makes no representations as to accuracy, completeness, suitability, or validity of any information on this website and will not be liable for any errors, omissions, or delays in this information or any losses, injuries, or damages arising from its display or use. All information is provided on an as-is basis. Terms are subject to change at any time and without notice.</p><button data-close aria-label="Close reveal" type="button" class="close-button"><span aria-hidden="true"><i class="fi-x"></i></span></button></div><div id="gpgModal" data-reveal class="large reveal"><h4 id="606e-f119-76e6-8e9a-6a45-25be-ea8a-8239-a2f8-008a"><a class="heading-anchor" href="#606e-f119-76e6-8e9a-6a45-25be-ea8a-8239-a2f8-008a"><span></span></a><i class="fi-key"></i>606E F119 76E6 8E9A 6A45  25BE EA8A 8239 A2F8 008A</h4><p class="lead">This is my current personal GPG public key fingerprint and QR code link<a href="https://pgp.mit.edu/pks/lookup?op=get&amp;search=0xEA8A8239A2F8008A"> to my public key on the MIT PGP keyserver.<img src="/img/Joseph_Brian_Shumate-key.png" alt="Joseph Brian Shumate GPG key fingerprint"></a></p><button data-close aria-label="Close reveal" type="button" class="close-button"><span aria-hidden="true"><i class="fi-x"></i></span></button></div><script src="/js/main.min.js"></script><script src="//static.getclicky.com/js" type="text/javascript"></script><script type="text/javascript">try{ clicky.init(100614799); }catch(e){}</script><noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100614799ns.gif"></p></noscript><script>(function(){
var t,i,e,n=window,o=document,a=arguments,s="script",r=["config","track","identify","visit","push","call"],c=function(){var t,i=this;for(i._e=[],t=0;r.length>t;t++)(function(t){i[t]=function(){return i._e.push([t].concat(Array.prototype.slice.call(arguments,0))),i}})(r[t])};for(n._w=n._w||{},t=0;a.length>t;t++)n._w[a[t]]=n[a[t]]=n[a[t]]||new c;i=o.createElement(s),i.async=1,i.src="//static.woopra.com/js/w.js",e=o.getElementsByTagName(s)[0],e.parentNode.insertBefore(i,e)
})("woopra");
woopra.config({
domain: 'brianshumate.com',
idle_timeout: 1800000
});
woopra.track()</script></html>