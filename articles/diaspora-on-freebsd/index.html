<!DOCTYPE html><html><head><title>Diaspora on FreeBSD | Brian Shumate</title><meta charset="utf-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="apple-touch-icon-precomposed" sizes="57x57" href="/img/apple-touch-icon-57x57.png"><link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/apple-touch-icon-114x114.png"><link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/apple-touch-icon-72x72.png"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144x144.png"><link rel="apple-touch-icon-precomposed" sizes="60x60" href="/img/apple-touch-icon-60x60.png"><link rel="apple-touch-icon-precomposed" sizes="120x120" href="/img/apple-touch-icon-120x120.png"><link rel="apple-touch-icon-precomposed" sizes="76x76" href="/img/apple-touch-icon-76x76.png"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="/img/apple-touch-icon-152x152.png"><link rel="icon" type="image/png" href="/img/favicon-196x196.png" sizes="196x196"><link rel="icon" type="image/png" href="/img/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32"><link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/img/favicon-128.png" sizes="128x128"><meta name="application-name" content="Brian Shumate"><meta name="msapplication-TileColor" content="#F5AB35"><meta name="msapplication-TileImage" content="/img/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="/img/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="/img/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="/img/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="/img/mstile-310x310.png"><link rel="stylesheet" href="/css/foundation.css"><link rel="stylesheet" href="/css/foundation-icons.css"><link rel="stylesheet" href="/css/prism.css"><link rel="stylesheet" href="/css/app.css"><script src="//use.edgefonts.net/orbitron.js"></script></head><body><header><div class="top-bar"><div class="top-bar-left"><ul class="menu"><li class="menu-text"><a href="/"><img src="/img/brand.svg" width="24" height="24" class="svg-inject brand-all"><span>Brian </span><span>Shumate</span></a></li></ul></div><div class="top-bar-right"><ul class="menu"><li><a href="/about/">About</a></li><li><a href="/articles/">Articles</a></li><li><a href="/now/">Now</a></li><li><a href="/projects/">Projects</a></li></ul></div></div></header><div id="article-layout-main"><div class="row medium-8 large-7 columns"><article id="article"><br><hr class="dotted"><h1 id="diaspora-on-freebsd"><a class="heading-anchor" href="#diaspora-on-freebsd"><span></span></a>Diaspora on FreeBSD</h1><i><h5 id="-january-4th-2012-reading-time-2-min"><a class="heading-anchor" href="#-january-4th-2012-reading-time-2-min"><span></span></a> <i>January 4th, 2012&#xA0;&#xA0;&#xA0;</i><i class="fi-clock">&#xA0;&#xA0;Reading time 2 min</i></h5></i><div><p>This is a small collection of brief notes and specs for installing a <a href="http://github.com/diaspora/diaspora">Diaspora*</a> project pod instance on
FreeBSD 8.2, which is the setup I <del>am</del> was using at the create-o-plex pod before I stopped operating it.</p>
<!--more-->
<p>I refer to these notes along with the Diaspora* <a href="https://github.com/diaspora/diaspora/wiki/Installing-and-Running-Diaspora">installation instructions</a> to get set up and running.</p>
<div class="callout secondary"><strong>PLEASE NOTE</strong>: This content contains outdated and possibly irrelevant information.</div>

<h2 id="install-prerequisite-ports"><a class="heading-anchor" href="#install-prerequisite-ports"><span></span></a>Install prerequisite ports</h2>
<p>These are the ports which you should update and install prior to cloning the Diaspora Github repository:</p>
<ul>
<li>git</li>
<li>ImageMagick</li>
<li>libxml2</li>
<li>mysql51-server</li>
<li>www/nginx</li>
<li>redis</li>
<li>ruby19</li>
<li>sqlite3</li>
</ul>
<h2 id="install-bundler"><a class="heading-anchor" href="#install-bundler"><span></span></a>Install bundler</h2>
<p>You need to install the Ruby <code>bundler</code> utility for use with Diaspora:</p>
<pre><code class="language-bash"><span class="token function">sudo</span> gem <span class="token function">install</span> bundler
</code></pre>
<h2 id="example-configurations"><a class="heading-anchor" href="#example-configurations"><span></span></a>Example Configurations</h2>
<p>Here are some examples and snippets based on the configuration files I use in my FreeBSD based setup. Please note that my setup is experimental and although it runs in production mode and is monitored, it supports limited users and runs on a server with modest resources. These examples are just that. YMMV, etc. ;)</p>
<h3 id="-usr-local-etc-redis-conf"><a class="heading-anchor" href="#-usr-local-etc-redis-conf"><span></span></a>/usr/local/etc/redis.conf</h3>
<pre><code class="language-config">daemonize yes
pidfile /var/run/redis/redis.pid
bind 127.0.0.1
port 6379
timeout 300
loglevel verbose
logfile /path_to_log_dir/redis/redis.log
databases 16
save 900 1
save 300 10
save 60 10000
rdbcompression yes
dbfilename dump.rdb
dir /home/db/redis/
appendonly no
appendfsync everysec
vm-enabled no
vm-swap-file /tmp/redis.swap
vm-max-memory 0
vm-page-size 32
vm-pages 134217728
vm-max-threads 4
glueoutputbuf yes
hash-max-zipmap-entries 64
hash-max-zipmap-value 512
</code></pre>
<h3 id="script_server-yml"><a class="heading-anchor" href="#script_server-yml"><span></span></a>script_server.yml</h3>
<pre><code class="language-yaml">script_server<span class="token punctuation">:</span>
  <span class="token comment" spellcheck="true"># Choose database. Currently supported: mysql, postgres</span>
  <span class="token key atrule">db</span><span class="token punctuation">:</span> <span class="token string">&quot;mysql&quot;</span>

  <span class="token comment" spellcheck="true"># Enable thin as application server</span>
  <span class="token key atrule">enable_thin</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>

  <span class="token comment" spellcheck="true"># Port on which thin should listen</span>
  <span class="token key atrule">thin_port</span><span class="token punctuation">:</span> <span class="token number">3000</span>

  <span class="token comment" spellcheck="true"># We&apos;re running our Thin instances on sockets instead of ports</span>
  <span class="token key atrule">default_thin_args</span><span class="token punctuation">:</span> <span class="token string">&quot;--servers 3 --socket /tmp/thin.sock&quot;</span>

  <span class="token comment" spellcheck="true"># Possibilities are development, production</span>
  <span class="token key atrule">rails_env</span><span class="token punctuation">:</span> <span class="token string">&quot;production&quot;</span>
</code></pre>
<h3 id="nginx-conf"><a class="heading-anchor" href="#nginx-conf"><span></span></a>nginx.conf</h3>
<p>Relevant snippet from the <code>nginx.conf</code> showing sockets for Thin:</p>
<pre><code class="language-nginx"><span class="token keyword">upstream</span> thin_cluster <span class="token punctuation">{</span>
    <span class="token keyword">server</span>   unix<span class="token punctuation">:</span><span class="token operator">/</span>tmp<span class="token operator">/</span>thin<span class="token number">.0</span><span class="token punctuation">.</span>sock<span class="token punctuation">;</span>
    <span class="token keyword">server</span>   unix<span class="token punctuation">:</span><span class="token operator">/</span>tmp<span class="token operator">/</span>thin<span class="token number">.1</span><span class="token punctuation">.</span>sock<span class="token punctuation">;</span>
    <span class="token keyword">server</span>   unix<span class="token punctuation">:</span><span class="token operator">/</span>tmp<span class="token operator">/</span>thin<span class="token number">.2</span><span class="token punctuation">.</span>sock<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="notes"><a class="heading-anchor" href="#notes"><span></span></a>Notes</h2>
<h3 id="bundle-install-phase"><a class="heading-anchor" href="#bundle-install-phase"><span></span></a>Bundle Install Phase</h3>
<p>SQLite3 gem install will fail to find includes at build time without setting this prior to running <code>bundle install</code>:</p>
<pre><code class="language-bash"><span class="token function">export</span> CONFIGURE_ARGS<span class="token operator">=</span><span class="token string">&quot;with-sqlite3-include=/usr/local/include&quot;</span>
</code></pre>
</div><hr class="dotted"></article></div></div></body><footer><div class="row expanded callout secondary"><div class="large-4 columns"><h5 id="-photographie"><a class="heading-anchor" href="#-photographie"><span></span></a><i class="fi-camera"> </i>PHOTOGRAPHIE</h5><div class="row small-up-4"><div class="column"><a href="https://500px.com/photo/128380667/the-mist-by-brian-shumate"><img src="/img/500px/stock-photo-128380667.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/92822883/orb-by-brian-shumate"><img src="/img/500px/stock-photo-128380669.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380671/bee-by-brian-shumate"><img src="/img/500px/stock-photo-128380671.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380673/cicada-by-brian-shumate"><img src="/img/500px/stock-photo-128380673.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380675/butterfly-by-brian-shumate"><img src="/img/500px/stock-photo-128380675.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380677/foggy-fall-by-brian-shumate"><img src="/img/500px/stock-photo-128380677.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380679/old-homestead-by-brian-shumate"><img src="/img/500px/stock-photo-128380679.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div><div class="column"><a href="https://500px.com/photo/128380695/foggy-morning-by-brian-shumate"><img src="/img/500px/stock-photo-128380695.jpg" alt="500px thumbnail" height="140" width="140" class="thumbnail"></a></div></div></div><div class="large-4 columns"><h5 id="choses-sociales-"><a class="heading-anchor" href="#choses-sociales-"><span></span></a><i class="fi-at-sign"></i>CHOSES SOCIALES<br><a href="https://twitter.com/brianshumate" title="Brian Shumate on Twitter"><i class="fi-social-twitter size-60"> </i></a><a href="https://github.com/brianshumate" title="Brian Shumate on GitHub"><i class="fi-social-github size-60"> </i></a><a href="https://500px.com/brianshumate" title="Brian Shumate on 500px"><i class="fi-social-500px size-60"> </i></a><a href="https://keybase.io/brianshumate" title="Brian Shumate on Keybase.io"><i class="fi-key size-60"></i></a></h5></div><div class="large-4 columns"><h5 id="de-la-fort"><a class="heading-anchor" href="#de-la-fort"><span></span></a><i class="fi-trees"></i>DE LA FOR&#xCA;T</h5><div id="hdt-quote" class="callout"><bloqckquote class="jsgood"><p>&#x201C;We must walk consciously only part way toward our goal, and then leap in the dark to our success.&#x201D;<br><br>&#x2014;Henry David Thoreau</p></bloqckquote><noscript><bloqckquote><p>&#x201C;We must walk consciously only part way toward our goal, and then leap in the dark to our success.&#x201D;<br><br>&#x2014;Henry David Thoreau</p></bloqckquote></noscript><p></p></div></div></div><div class="row expanded"><div class="medium-6 columns"><ul class="menu"><li><a href="/about/">About</a></li><li><a data-open="disclaimerModal">Disclaimer</a></li><li><a data-open="gpgModal">GPG</a></li><li><a href="/license/">License</a></li></ul></div><div class="medium-6 columns"><ul class="menu align-right"><li class="menu-text">Copyright &#xA9; 2019 Brian Shumate</li></ul></div></div></footer><div id="disclaimerModal" data-reveal="" class="large reveal"><h1 id="disclaimer"><a class="heading-anchor" href="#disclaimer"><span></span></a><i class="fi-info"></i>DISCLAIMER</h1><p class="lead">This is a personal website comprised of personally held opinions. All content provided on this website is for informational purposes only. Brian Shumate makes no representations as to accuracy, completeness, suitability, or validity of any information on this website and will not be liable for any errors, omissions, or delays in this information or any losses, injuries, or damages arising from its display or use. All information is provided on an as-is basis. Terms are subject to change at any time and without notice.</p><button data-close="" aria-label="Close reveal" type="button" class="close-button"><span aria-hidden="true"><i class="fi-x"></i></span></button></div><div id="gpgModal" data-reveal="" class="large reveal"><h4 id="606e-f119-76e6-8e9a-6a45-25be-ea8a-8239-a2f8-008a"><a class="heading-anchor" href="#606e-f119-76e6-8e9a-6a45-25be-ea8a-8239-a2f8-008a"><span></span></a><i class="fi-key"></i>606E F119 76E6 8E9A 6A45  25BE EA8A 8239 A2F8 008A</h4><p class="lead">This is my current personal GPG public key fingerprint and QR code link<a href="https://pgp.mit.edu/pks/lookup?op=get&amp;search=0xEA8A8239A2F8008A"> to my public key on the MIT PGP keyserver.<img src="/img/Joseph_Brian_Shumate-key.png" alt="Joseph Brian Shumate GPG key fingerprint"></a></p><button data-close="" aria-label="Close reveal" type="button" class="close-button"><span aria-hidden="true"><i class="fi-x"></i></span></button></div><script src="/js/main.min.js"></script><script src="//static.getclicky.com/js" type="text/javascript"></script><script type="text/javascript">try{ clicky.init(100614799); }catch(e){}</script><noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100614799ns.gif"></p></noscript><script>(function(){
var t,i,e,n=window,o=document,a=arguments,s="script",r=["config","track","identify","visit","push","call"],c=function(){var t,i=this;for(i._e=[],t=0;r.length>t;t++)(function(t){i[t]=function(){return i._e.push([t].concat(Array.prototype.slice.call(arguments,0))),i}})(r[t])};for(n._w=n._w||{},t=0;a.length>t;t++)n._w[a[t]]=n[a[t]]=n[a[t]]||new c;i=o.createElement(s),i.async=1,i.src="//static.woopra.com/js/w.js",e=o.getElementsByTagName(s)[0],e.parentNode.insertBefore(i,e)
})("woopra");
woopra.config({
domain: 'brianshumate.com',
idle_timeout: 1800000
});
woopra.track()</script></html>